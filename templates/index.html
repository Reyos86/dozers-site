<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dozer's Live Storm Chasing Team</title>
    <link rel="icon" href="{{ url_for('static', filename='Dozerfavicon.png') }}" type="image/png">	
    <style>
	  html, body {
	    height: 100%;
	    margin: 0;
	    padding-top: 80px;
	    font-family: Arial, sans-serif;
	    background: #000 url("{{ url_for('static', filename='083f71dc-03e0-4d24-b241-2afbe55c8de3.png') }}") no-repeat center center fixed;
	    background-size: cover;
	    color: #eee;
	    text-align: center;
	    overflow-x: hidden;
	  }

  /* Mobile fix: disable background-attachment fixed on small screens */
  @media (max-width: 768px) {
    body {
      background-attachment: scroll;
    }
  }

        img {
            max-width: 100%;
            height: auto;
        }

        .main-content {
            flex: 1;
        }

        .message-board {
            max-width: 600px;
            margin: 20px auto;
            padding: 1em;
            background: #222;
            border-radius: 8px;
        }
		
		.message-board ul {
			list-style: none;
			padding: 0;
			text-align: left;
		}

		.message-board li {
			padding: 5px 10px;
			border-bottom: 1px solid #444;
		}

        input, textarea {
            width: 90%;
            padding: 0.5em;
            margin: 0.5em 0;
            border-radius: 4px;
            border: none;
        }

        .discord-button {
            background-color: #5865F2; /* Discord blurple */
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            text-decoration: none;
            font-weight: bold;
            font-family: sans-serif;
            display: inline-block;
            transition: background-color 0.2s ease;
        }

        .discord-button:hover {
            background-color: #4752C4;
        }
		.about-section {
			max-width: 800px;
			margin: 30px auto;
			padding: 20px 30px;
			background: linear-gradient(135deg, rgba(0,0,0,0.8), rgba(0,25,50,0.6));
			border-radius: 16px;
			box-shadow: 0 0 20px rgba(0,0,0,0.4);
			color: #f0f0f0;
			font-family: Arial, sans-serif;
			text-align: left;
			backdrop-filter: blur(6px);
		}

		.about-section h2 {
			font-size: 2em;
			margin-bottom: 15px;
			color: #ffffff;
			letter-spacing: 1px;
		}

		.about-section p {
			font-size: 1.1em;
			line-height: 1.6;
			color: #dddddd;
			margin: 10px 0;
		}
		.founders-section {
			max-width: 1200px;
			margin: 40px auto;
			padding: 1em;
			background: rgba(0, 0, 0, 0.6);
			border-radius: 12px;
		}

		.founders-section h2 {
			margin-bottom: 20px;
			color: #fff;
			text-align: center;
		}

		.founders-grid {
			display: flex;
			flex-wrap: wrap;
			justify-content: center;
			gap: 20px;
		}

		.founder-card {
		  background: #1a1a1a;
		  border-radius: 12px;
		  padding: 1.2em;
		  width: 300px;
		  color: #eee;
		  text-align: center;
		  box-shadow: 0 0 12px rgba(0,0,0,0.5);
		  display: flex;
		  flex-direction: column;
		  justify-content: space-between;
		}

		.founder-card img {
			width: 100px;
			height: 100px;
			border-radius: 50%;
			object-fit: cover;
			margin-bottom: 10px;
		}
	    
		.founder-card .nickname {
			  font-style: italic;
			  font-size: 0.95em;
			  color: #aaa;
			  margin-bottom: 10px;
		}	    

		.founder-card .bio {
		  font-size: 0.9em;
		  line-height: 1.5;
		  margin-bottom: 12px;
		}
		
		.founder-stats {
		  margin-top: 10px;
		  background: rgba(255, 255, 255, 0.05);
		  border-radius: 10px;
		  padding: 10px 12px;
		  text-align: left;
		}
		
		.founder-stats h4 {
		  color: #0cf;
		  font-size: 1em;
		  margin-bottom: 6px;
		  text-align: center;
		}
		
		.founder-stats ul {
		  list-style: none;
		  padding: 0;
		  margin: 0;
		  font-size: 0.9em;
		}
		
		.founder-stats li {
		  margin: 4px 0;
		  display: flex;
		  gap: 6px;
		  align-items: center;
		}
		
		.founder-stats li span {
		  font-size: 1.1em;
		}	    
		.founder-card h3 {
			  margin-top: 10px;
			  font-size: 1.3em;
			  color: #ffffff;
		}

		.founder-card p {
			font-size: 0.9em;
			line-height: 1.4;
			margin-bottom: 10px;
		}

		.social-links a {
			font-size: 1.5em;
			margin: 0 6px;
			color: #eee;
			text-decoration: none;
			transition: color 0.2s ease;
		}

		.social-links a:hover {
			color: #00aaff;
		}

		.navbar {
		  display: flex;
		  justify-content: center;
		  gap: 40px;
		  padding: 15px 0;
		  background: rgba(0, 0, 0, 0.7);
		  position: fixed;
		  width: 100%;
		  top: 0;
		  z-index: 999;
		  backdrop-filter: blur(6px);
		}
		
		.navbar a {
		  color: #eee;
		  text-decoration: none;
		  font-weight: bold;
		  font-size: 1rem;
		  transition: color 0.2s ease;
		}
		
		.navbar a:hover {
		  color: #00aaff;
		}

		.featured-video {
		  width: 90%;
		  max-width: 1000px;
		  margin: 40px auto;
		  padding: 30px;
		  background: rgba(0, 0, 0, 0.6);
		  border-radius: 16px;
		  box-shadow: 0 0 20px rgba(0,0,0,0.4);
		  backdrop-filter: blur(6px);
		  text-align: center;
		}
		
		.featured-video h2 {
		  font-size: 2.4em;
		  margin-bottom: 20px;
		  color: #f0f0f0;
		}
		
		.video-wrapper {
		  position: relative;
		  padding-bottom: 56.25%; /* 16:9 */
		  height: 0;
		  overflow: hidden;
		  border-radius: 12px;
		  max-width: 100%;
		}
		
		.video-wrapper iframe {
		  position: absolute;
		  top: 0;
		  left: 0;
		  width: 100%;
		  height: 100%;
		  border: none;
		  border-radius: 12px;
		}
		
		  .weather-widget {
			max-width: 600px;
			margin: 20px auto 40px;
			padding: 20px;
			background: rgba(0,0,0,0.65);
			border-radius: 12px;
			color: #eee;
			font-family: Arial, sans-serif;
			box-shadow: 0 0 10px rgba(0,0,0,0.4);
			text-align: center;
		  }

		  .weather-location {
			font-size: 1.4em;
			font-weight: bold;
			margin-bottom: 10px;
			color: #00aaff;
		  }

		  .weather-info {
			font-size: 1em;
			margin-bottom: 10px;
		  }

		  .weather-alert a {
			color: #ff4c4c;
			font-weight: bold;
			text-decoration: underline;
		  }	
		.live-grid {
		  display: flex;
		  flex-wrap: wrap;
		  justify-content: center;
		  gap: 30px;
		  margin: 20px auto;
		  max-width: 1400px;
		}
		
		.live-card {
		  background: #111;
		  border-radius: 12px;
		  padding: 10px;
		  width: 100%;
		  max-width: 640px;
		  color: #fff;
		  box-shadow: 0 0 12px rgba(0, 0, 0, 0.4);
		  text-align: center;
		}
		
		.live-card iframe {
		  width: 100%;
		  height: 360px;
		  border: none;
		  border-radius: 8px;
		  display: block;
		}
		
		.live-now-section {
		  margin: 40px auto;
		  padding: 20px;
		  background: rgba(0,0,0,0.6);
		  border-radius: 16px;
		  max-width: 1500px;
		  box-shadow: 0 0 20px rgba(0,0,0,0.4);
		  text-align: center;
		}
		
		.live-now-section h2 {
		  color: #ff4c4c;
		  font-size: 1.8em;
		  margin-bottom: 20px;
		}

			
    </style>
</head>
<body>
<a id="top"></a>
	<div class="navbar">
	  <a href="#top">Home</a>
	  <a href="/media">Media</a>
	  <a href="https://trello.com/b/oXuJZS7p/dozers-team" target="_blank">Trello</a>
	  <a href="#message">Message Board</a>
	  <a href="https://www.windy.com/-Menu/menu?radar,36.792,-95.317,5,p:favs" target="_blank">Live Weather</a>
								
	</div>
		
	<!-- Weather Widget Section -->
	<div class="weather-widget" id="weatherWidget">
	  <div class="weather-location" id="weatherLocation">Loading location...</div>
	  <div class="weather-info" id="weatherInfo"></div>
  	  <span id="weatherText"></span>
          <img id="weatherIcon" style="width: 32px; vertical-align: middle; display: none;" alt="Weather icon">	
	  <div class="weather-alert" id="weatherAlert"></div>
	</div>

	<script>
	  async function fetchWeather() {
	    try {
	      const res = await fetch("/weather");
	      const data = await res.json();
	
	      if (data.error) throw new Error(data.error);
	
	      // Location and temperature
	      document.getElementById("weatherLocation").textContent = `${data.location.city}, ${data.location.region}`;
	      document.getElementById("weatherText").textContent = `${Math.round(data.temperature)}°F — ${data.narrative}`;
	
	      // Weather icon
	      const iconCode = data.icon;
	      const iconImg = document.getElementById("weatherIcon");
	      iconImg.src = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;
	      iconImg.style.display = "inline"; // only show after src is set
	
	      // Alert
	      if (data.alert) {
		const alert = data.alert;
		document.getElementById("weatherAlert").innerHTML =
		  `🚨 <strong>${alert.event}</strong><br><em>${alert.sender}</em>`;
	      } else {
		document.getElementById("weatherAlert").innerHTML = "";
	      }
	    } catch (error) {
	      console.error("JS error:", error);
	      document.getElementById("weatherLocation").textContent = "Unable to load weather data.";
	    }
	  }

	async function checkTwitchLive() {
	  try {
	    const res = await fetch('/twitch_status');
	    const data = await res.json();
	
	    if (data.live) {
	      const liveNowSection = document.getElementById("live-now");
	      liveNowSection.style.display = "block";
	
	      const streamEmbed = `
	        <div class="live-card">
	          <iframe
	            src="https://player.twitch.tv/?channel=reyos86&parent=${location.hostname}"
	            height="300"
	            width="100%"
	            allowfullscreen>
	          </iframe>
	          <p><strong>reyos86</strong> is live on Twitch!</p>
	        </div>
	      `;
	
	      document.getElementById("live-streams").innerHTML += streamEmbed;
	    }
	  } catch (err) {
	    console.error("Error checking Twitch live status:", err);
	  }
	}

	async function checkYouTubeLive() {
	  try {
	    const res = await fetch('/youtube_status');
	    const data = await res.json();
	
	    if (Array.isArray(data) && data.length > 0) {
	      const liveNowSection = document.getElementById("live-now");
	      liveNowSection.style.display = "block";
	
	      data.forEach(stream => {
	        const streamEmbed = `
	          <div class="live-card">
	            <iframe
	              src="https://www.youtube.com/embed/${stream.videoId}?autoplay=1"
	              height="300"
	              width="100%"
	              allowfullscreen>
	            </iframe>
	            <p><strong>${stream.name}</strong> is live on YouTube!</p>
	          </div>
	        `;
	        document.getElementById("live-streams").innerHTML += streamEmbed;
	      });
	    }
	  } catch (err) {
	    console.error("Error checking YouTube live status:", err);
	  }
	}
		
	window.onload = () => {
	  fetchWeather();
	  checkTwitchLive();
  	  checkYouTubeLive();		
	};
	</script>

	
			
    <div class="main-content">
        <h1>🌪️ Dozer's Live Storm Chasing Team 🌪️</h1>
        <img src="{{ url_for('static', filename='dozers.png') }}" alt="Dozer's Logo" style="width: 300px; height: auto;">
        <p>
            <a href="https://discord.gg/H4CxMK73zZ" class="discord-button" target="_blank">
                Join our Discord
            </a>
        </p>
    </div>

	<div id="live-now" class="live-now-section" style="display: none;">
	  <h2>🔴 Live Storm Chasers</h2>
	  <div id="live-streams" class="live-grid"></div>
	</div>
	
	<div class="about-section">
		<h2>About Us</h2>
		<p>
			We met while chasing tornadoes in the game Outbrk, and it didn’t take long for the chaos to turn into camaraderie. Our chill-but-outgoing personalities just clicked, and before we knew it, we had a convoy — or at least a van full of Jeffs — barreling toward the next storm. We’re here to have a good time, throw down some probes, and maybe yell over each other on comms when that radar hook tightens up.
		</p>
		<p>
			At the core, Dozer’s Live Storm Chasing Team is about community. We love bringing new players into the chase, helping them learn the ropes, and keeping our viewers part of the action during every stream. Whether you’re riding along for laughs, learning to intercept, or just vibing in chat — welcome to the team!
		</p>
	</div>

	<div class="featured-video">
	  <h2>🎬 Featured Video</h2>
	  <div class="video-wrapper">
	    <iframe 
	      src="https://www.youtube.com/embed/0B9r6stI7cI" 
	      title="YouTube video player" 
	      frameborder="0"
	      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
	      allowfullscreen>
	    </iframe>
	  </div>
	</div>


	<div class="founders-section">
		<h2>Meet the Founders</h2>
		<div class="founders-grid">
			{% for founder in founders %}
			<div class="founder-card">
			  <img src="{{ url_for('static', filename=founder.image) }}" alt="{{ founder.name }}">
			  <h3>{{ founder.name }}</h3>
			  <p class="nickname">{{ founder.nickname }}</p>
			  <p class="bio">{{ founder.bio }}</p>
			
			  <div class="social-links">
			    {% if founder.youtube %}
			    <a href="{{ founder.youtube }}" target="_blank">📺</a>
			    {% endif %}
			    {% if founder.twitch %}
			    <a href="{{ founder.twitch }}" target="_blank">🎮</a>
			    {% endif %}
			  </div>
			
			  {% if founder.stats %}
			  <div class="founder-stats">
			    <h4>🌪️ OUTBRK Stats</h4>
			    <ul>
			      <li><span>🚙</span> <strong>Driven:</strong> {{ founder.stats.driven_miles }} mi</li>
			      <li><span>👟</span> <strong>On Foot:</strong> {{ founder.stats.foot_miles }} mi</li>
			      <li><span>🎯</span> <strong>Direct Hits:</strong> {{ founder.stats.direct_intercepts }}</li>
			      <li><span>📡</span> <strong>Probes Deployed:</strong> {{ founder.stats.probes_deployed }}</li>
			      <li><span>📥</span> <strong>Probes Recovered:</strong> {{ founder.stats.probes_recovered }}</li>
			      <li><span>🏆</span> <strong>Best Score:</strong> {{ founder.stats.best_chase_score }}</li>
			    </ul>
			  </div>
			  {% endif %}
			</div>

			{% endfor %}
		</div>
	</div>
<a id="message"></a>
    <div class="message-board">
        <h2>Message Board</h2>
        <form method="POST">
            <input name="username" placeholder="Your name" required><br>
            <textarea name="message" placeholder="Your message" required></textarea><br>
            <button type="submit">Post</button>
        </form>
        <ul>
            {% for msg in messages %}
                <li><strong>{{ msg.username }}:</strong> {{ msg.message }}</li>
            {% endfor %}
        </ul>
    </div>
</script>
</body>
</html>
